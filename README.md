# üç© Simpsons Character Classification

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –º—É–ª—å—Ç—Å–µ—Ä–∏–∞–ª–∞ "–°–∏–º–ø—Å–æ–Ω—ã" —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (PyTorch).

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ [The Simpsons Characters](https://www.kaggle.com/datasets/alexattia/the-simpsons-characters-dataset).

**–ó–∞–¥–∞—á–∞:** –ü–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –ø–µ—Ä—Å–æ–Ω–∞–∂ –Ω–∞ –Ω—ë–º –∏–∑–æ–±—Ä–∞–∂—ë–Ω.

**–ú–æ–¥–µ–ª—å:** ResNet18 —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ (Transfer Learning)

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤:** 42 –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
simpson_classification/
‚îú‚îÄ‚îÄ README.md # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ pyproject.toml # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ uv.lock # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ .gitignore # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú
‚îÇ
‚îú‚îÄ‚îÄ configs/
‚îÇ ‚îî‚îÄ‚îÄ train_config.yaml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ src/ # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
‚îÇ ‚îú‚îÄ‚îÄ init.py
‚îÇ ‚îú‚îÄ‚îÄ dataset.py # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ ‚îú‚îÄ‚îÄ model.py # –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ train.py # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è (epoch)
‚îÇ ‚îú‚îÄ‚îÄ validate.py # –õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ ‚îî‚îÄ‚îÄ utils.py # –£—Ç–∏–ª–∏—Ç—ã (seed, etc.)
‚îÇ
‚îú‚îÄ‚îÄ scripts/ # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (CLI)
‚îÇ ‚îú‚îÄ‚îÄ download_data.py # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ ‚îú‚îÄ‚îÄ check_data.py # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îú‚îÄ‚îÄ train.py # –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
‚îÇ ‚îú‚îÄ‚îÄ val.py # –ó–∞–ø—É—Å–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ ‚îú‚îÄ‚îÄ test_model.py # –¢–µ—Å—Ç –º–æ–¥–µ–ª–∏
‚îÇ ‚îî‚îÄ‚îÄ test_dataloader.py # –¢–µ—Å—Ç DataLoader
‚îÇ
‚îú‚îÄ‚îÄ artifacts/ # –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–Ω–µ –≤ git)
‚îÇ ‚îú‚îÄ‚îÄ best_model.pth # –í–µ—Å–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ training_history.json # –ò—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ ‚îî‚îÄ‚îÄ config_used.json # –ö–æ–Ω—Ñ–∏–≥ –∑–∞–ø—É—Å–∫–∞


---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç


```bash
git clone <https://github.com/FedorSolodkin/Dl-Nsu/Lab1>
cd simpson_classification

# –°–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
uv venv

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Windows PowerShell)
.\.venv\Scripts\Activate.ps1

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv sync

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
uv pip install -e .

python scripts/download_data.py

python scripts/check_data.py

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–π–¥–µ–Ω–æ 42 –∫–ª–∞—Å—Å–∞ (–ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π).

–û—Ç–∫—Ä–æ–π—Ç–µ configs/train_config.yaml –∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É:

data:
  data_dir: "C:/Users/<YourUser>/.cache/kagglehub/datasets/.../simpsons_dataset"
  img_size: 224
  batch_size: 32
  num_workers: 0  # –î–ª—è Windows —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0
  train_split: 0.8

model:
  name: "resnet18"
  pretrained: true
  num_classes: 42

train:
  epochs: 10
  learning_rate: 0.001
  weight_decay: 0.0001
  device: "cpu"  # –ò–ª–∏ "cuda" –µ—Å–ª–∏ –µ—Å—Ç—å GPU NVIDIA
  seed: 42

artifacts:
  save_dir: "./artifacts"
  project_name: "simpsons-classification"

üèÉ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

python scripts/train.py
```
üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
–®–∞–≥
–û–ø–∏—Å–∞–Ω–∏–µ
1 –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç (80% train, 20% validation)
2 –°–æ–∑–¥–∞—ë—Ç—Å—è –º–æ–¥–µ–ª—å ResNet18 —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏
3 –û–±—É—á–µ–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ø–æ—Ö
4 –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏ ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è
5 –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ Validation Accuracy


üìà –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫
1. –ò—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è
–§–∞–π–ª: artifacts/training_history.json

–ú–µ—Ç—Ä–∏–∫–∞         –û–ø–∏—Å–∞–Ω–∏–µ
train_loss      Loss –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏ –ø–æ —ç–ø–æ—Ö–∞–º

train_acc       Accuracy –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏ –ø–æ —ç–ø–æ—Ö–∞–º

val_loss        Loss –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ —ç–ø–æ—Ö–∞–º

val_acc         Accuracy –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ —ç–ø–æ—Ö–∞–º

2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
```bash
python scripts/plot_metrics.py
```

–í—ã—Ö–æ–¥: artifacts/metrics.png ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ Loss –∏ Accuracy –ø–æ —ç–ø–æ—Ö–∞–º.

3. –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫–æ—Ä
–û—Ç–∫—Ä–æ–π—Ç–µ artifacts/training_history.json –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ val_acc:
{
  "val_acc": [35.0, 45.0, 52.0, ..., 72.5]
}
